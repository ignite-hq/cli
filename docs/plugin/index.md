---
order: 1
title: Plugin System
parent:
  title: Starport Plugin System
  order: 5
description: Description of Starport plugin system.
---

# Starport Plugin

`Starport plugin system` that we'd developed provides extended features to maximize flexibility in plugin environments.

- Plugin developers can publish their plugins with more flexibility within simple conditions.
- Chain developers can import those plugins dynamically in Starport for their use.

## How to use plugin system

### Step 1: Build Starport

Developers must build Starport first to use the Starport plugin system.

Checkout `develop` branch and build it.

```
~$ git checkout develop
~$ make build
~$ make install
```

### Step 2: Start new chain project

Please, start a new chain project which was created by Starport prior to testing the plugin system.

You can skip this part, if you already have a new chain project

or
Please, create a new chain project.

```
~$ starport scaffold chain github.com/cosmonaut/mars
```

Repository name might be changed.

### Step 3: Add plugin entry

Default `config.yml` file automatically is generated by Starport.
Please, add `plugins` information to configure plugins as described below.

**config.yml**
```
accounts:
  - name: me
    coins: ["1000tokens", "10000stakes"]
  
  - name: you
    coins: ["1000tokens", "10000stakes"]

validator:
  name: dsrv
  staked: "10000000stakes"

plugins:
  - name: hello-starport-plugin
    description: Demo plugin 1
    repository_url: https://github.com/rootwarp/starport-plugin-sample
  - name: arithmetic
    description: Demo plugin 2
    repository_url: https://github.com/rootwarp/starport-plugin-sample
```

`repository url` is literally a repository URL from Git and this repository should be public. 

Single repository may contain more than one plugin; the `name` field must be unique per plugin.
Developers can implement several plugins under one Git repository by separating them with subdirectories.
  `name` field must be match with the subdirectory name under a Git repository.

### Step 4: Install sample plugin.

Plugin info that was appended earlier on `config.yml` has to be installed manually as below.

First list plugin entry.If the plugin entry is added on `config.yml` appropriately,you can see new entry on list.

All plugins `INSTALLED` column are `false`.

```
~$ starport plugin list
+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
| # | NAME                  | INSTALLED | REPOSITORY URL                                     | DESCRIPTION                      |
+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
| 0 | hello-starport-plugin | false     | https://github.com/rootwarp/starport-plugin-sample |  Starport plugin system sample 1 |
| 1 | arithmetic            | false     | https://github.com/rootwarp/starport-plugin-sample |  Starport plugin system sample 2 |
+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
```

Please, install them one at a time. 

```
~$ starport plugin install hello-starport-plugin
```

You can check the whether plugin is installed properly or not after installation.
`INSTALLED` column should be `true` if the plugin is installed successfully. 

Installed plugins are located at `$HOME/.starport/plugins`.

```
~$ starport plugin list

+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
| # | NAME                  | INSTALLED | REPOSITORY URL                                     | DESCRIPTION                      |
+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
| 0 | hello-starport-plugin | true      | https://github.com/rootwarp/starport-plugin-sample |  Starport plugin system sample 1 |
| 1 | arithmetic            | false     | https://github.com/rootwarp/starport-plugin-sample |  Starport plugin system sample 2 |
+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
```

You can install 2nd plugin with command below and check it status again.
```
~$ starport plugin install arithmetic
~$ starport plugin list

+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
| # | NAME                  | INSTALLED | REPOSITORY URL                                     | DESCRIPTION                      |
+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
| 0 | hello-starport-plugin | true      | https://github.com/rootwarp/starport-plugin-sample |  Starport plugin system sample 1 |
| 1 | arithmetic            | true      | https://github.com/rootwarp/starport-plugin-sample |  Starport plugin system sample 2 |
+---+-----------------------+-----------+----------------------------------------------------+----------------------------------+
```

You can also check new command `hello-starport-plugin` on `scaffold`'s sub-command.

```
~$ starport scaffold
Scaffold commands create and modify the source code files to add functionality.

CRUD stands for "create, read, update, delete".

Usage:
  starport scaffold [command]

Aliases:
  scaffold, s

Available Commands:
  chain                 Fully-featured Cosmos SDK blockchain
  module                Scaffold a Cosmos SDK module
  list                  CRUD for data stored as an array
  map                   CRUD for data stored as key-value pairs
  single                CRUD for data stored in a single location
  type                  Scaffold only a type definition
  message               Message to perform state transition on the blockchain
  query                 Query to get data from the blockchain
  packet                Message for sending an IBC packet
  band                  Scaffold an IBC BandChain query oracle to request real-time data
  vue                   Vue 3 web app template
  hello-starport-plugin Starport plugin system sample

Flags:
  -h, --help   help for scaffold

Use "starport scaffold [command] --help" for more information about a command.
```

### Step 5: Execute sample plugin.

You can check plugin's available command as below.

```
~$ starport scaffold hello-starport-plugin 
Demo plugin

Usage:
  starport scaffold hello-starport-plugin [command]

Available Commands:
  Banner
  SayHello    Just say hello

Flags:
  -h, --help   help for hello-starport-plugin

Use "starport scaffold hello-starport-plugin [command] --help" for more information about a command.
```

Try to run `hello-starport-plugin` plugin's function command

```
~$ starport scaffold hello-starport-plugin Banner DSRV
2021/12/06 17:34:01 Initialize plugin

 ____   _____  _____  _____
|    \ |   __|| __  ||  |  |
|  |  ||__   ||    -||  |  |
|____/ |_____||__|__| \___/

~$ starport scaffold hello-starport-plugin SayHello DSRV
2021/12/07 01:42:08 Initialize plugin


================================================================================

Hello DSRV

================================================================================
```

## Plugin developer

- Directory architectures.
- Mandatory functions.
- Exporting symbol.

### Create repo and new directory

Single plugin repository can have several plugins, so these plugins should be separated by directory.

Directory name will be the same as plugins name as path. 
We have two sample plugins in this plugin project, 
- `hello-starport-plugin`
- `arithmetic`

Here's how repository' directory structure is like for sample plugins:

```
~$ tree
.
└── hello-starport-plugin
│    ├── go.mod
│    ├── go.sum
│    ├── hello-starport-plugin.so
│    ├── main.go
│    └── main_test.go
└── arithmetic
     ├── arithmetic.so
     ├── go.mod
     └── main.go

2 directories, 8 files
```

### Implement mandatory functions.

Starport plugin must have two mandatory functions.

- `Init()`
   - `Init()` function Initialize plugin and will be executed whenever the plugin system call plugin function.
- `Help(name string) string`
   - This function provide help text and plugin information at Starport plugin system. 
   - Starport will call this function with the plugin name as a parameter if the user call CLI with `--help` flag.

Starport plugin system will return an error If those two functions have not been implemented in the plugin when the user executes build and load plugin.

Here's what Starport plugin project may like.

```
package main

import (
	"log"
)

type hello struct {
}

func (p *hello) Init() {
	log.Println("Initialize plugin")
}

func (p *hello) Help(name string) string {
  return ""
}

var Plugin hello
```

Please, keep in mind that the variable named `Plugin` is defined at the end of the sample.

Starport tries to find `Plugin` variable from plugin symbol to load implemented functions 
when Starport plugin system loads plugin, and therefore 
plugin developer MUST provide this variable for working with Starport plugin system.
